function downloadFile(e,t){var n=fileUrls[count].substring(fileUrls[count].lastIndexOf("/")+1);$(".fd-download-status").text("downloading "+n+" ..."),JSZipUtils.getBinaryContent(e,function(e,n){e?console.log("ERROR",e):t(n)})}function onDownloadComplete(e){count<fileUrls.length&&blobToBase64(e,function(e){var t=fileUrls[count].substring(fileUrls[count].lastIndexOf("/")+1);if(zip.file(t,e,{binary:!0}),count<fileUrls.length-1)count++,downloadFile(fileUrls[count],onDownloadComplete);else{$(".fd-download-status").text("processing PDFs... please wait until browser is responding again (up to a minute)");var n=zip.generate(),o=$("#content-wrap #content #main #resultwindow .detailright .title").text(),l=o.replace(/\s/g,"-"),i=l+".zip";$(".fd-download-status").text("sweet!"),$(".fd-download-loading-bar").fadeOut(),$(".fd-download-button").removeClass("disabled"),count=0;var d=document.createElement("a");d.download=i,d.href="data:application/zip;base64,"+n,document.body.appendChild(d),d.click(),document.body.removeChild(d),delete d}})}function blobToBase64(e,t){var n=!1;if(n){var o=new FileReader;o.onload=function(){var e=o.result,n=e.split(",")[1];t(n)},o.readAsDataURL(e)}else t(e)}function calculateAndUpdateProgress(e){e.lengthComputable&&console.log("evt")}var download_element='	<div class="frame-demolition">		<button class="fd-download-button waves-effect waves-light btn pink" id="fddownload"><i class="material-icons left"></i>Download All</button>		<span class="fd-download-status">notice: your browser will stop responding for up to a minute when downloading</span>		<div class="fd-download-loading-bar progress light-green" style="display:none;">			<div class="indeterminate"></div>		</div>	</div>';$(download_element).appendTo(".detailright");var jumpto_element='	<button class="fd-jump-to-download-button waves-effect waves-light btn teal" id="fdjumptodownload">to download</button>';$(jumpto_element).appendTo(".detailleft"),document.getElementById("fdjumptodownload").addEventListener("click",function(){var e=$("html,body"),t=$(".fd-download-button");e.animate({scrollTop:t.offset().top-e.offset().top-300,srollLeft:0},300)});var target_element=document.getElementById("fddownload");target_element.addEventListener("click",function(){$(".fd-download-loading-bar").fadeIn(),$(".fd-download-button").addClass("disabled"),downloadFile(fileUrls[count],onDownloadComplete)});for(var section_list=$(".detailright ol li"),individual_section,section_link,links=[],extension_regex=/(?:\.([^.]+))?$/,i=0;i<section_list.length;i++){individual_section=$(".detailright ol li a:eq("+i+")"),section_link=individual_section[0].getAttribute("href");var extension=extension_regex.exec(section_link)[1];"pdf"==extension?(section_link=section_link.replace("ft_viewer.php?fname=",""),section_link="http://dewey.petra.ac.id/repository/jiunkpe/"+section_link):section_link="jpg"==extension?section_link:null,section_link&&links.push(section_link)}var fileUrls=links,zip=new JSZip,count=0,detailright_text=$(".detailright p").text();$(".detailright p").html(detailright_text);